#!/bin/sh
##################
# Puppet managed #
##################

DOMAIN=$1

u_sure() {
  echo "Launching a backup of $DOMAIN to $SERVER ..."
}

case "$DOMAIN" in
<% webserver_domains.each do |k,v| -%>
  <%= v['name'] %>)
    SERVER=<%= v['web_backups_server'] %>
    u_sure
    <%= "/usr/local/sbin/backup.rb $DOMAIN $SERVER #{v['web_backups_server_port']||22} #{v['history']||7} #{v['excludes']}" %>
    ;;
<% end -%>
  *)
    echo "Usage: backup domain.name"
    exit 1
esac

exit 0
