################## 
# puppet managed #
################## 
# 
# Customize your httpd configuration at: 
# /var/www/<%=name%>/conf/vhost.conf

<VirtualHost *:80>
<% if force_www == 'true' -%>
  ServerName   www.<%=name%>
<% else -%>
  ServerName   <%=name%>
  ServerAlias  www.<%=name%>
<% end -%>
  UseCanonicalName Off
  ServerAdmin  "webmaster@<%=name%>"
  DocumentRoot /var/www/<%=name%>/htdocs
  CustomLog  /var/www/<%=name%>/logs/access_log combined
  ErrorLog  /var/www/<%=name%>/logs/error_log
  ScriptAlias  /cgi-bin/ /var/www/<%=name%>/cgi-bin/

  <Directory /var/www/<%=name%>/htdocs>
    Options FollowSymLinks
    AllowOverride None
    Order allow,deny
    Allow from all
  </Directory>

  Include /var/www/<%=name%>/conf/vhost.conf

</VirtualHost>
<% if force_www == 'true' -%>

<VirtualHost *:80>
  ServerName   <%=name%>
  # redirect all requests to www.<%=name%>
  RewriteEngine On
  RewriteCond %{REQUEST_URI} !^/awstats(.*)$ [NC]
  RewriteRule ^/(.*)         http://www.<%=name%>/$1 [L,R]
</VirtualHost>
<% end -%>
